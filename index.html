<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no">
    <meta name="google-adsense-account" content="ca-pub-7258774526539144">
    <title>ë‘ë°”ì´ì«€ë“ì¿ í‚¤: ì‚¬ë¨¹ì ì„œë¯¼ë“¤ì•„</title>
    <!-- ì¦‰ì‹œ ì‹¤í–‰: ìƒˆë¡œê³ ì¹¨ ì‹œ í™”ë©´ ë°€ë¦¼ ë°©ì§€ -->
    <script>
        (function() {
            'use strict';
            // ì¦‰ì‹œ ìŠ¤í¬ë¡¤ ë°©ì§€
            window.scrollTo(0, 0);
            document.documentElement.scrollTop = 0;
            if (document.body) document.body.scrollTop = 0;
            
            // ì¦‰ì‹œ ìŠ¤í¬ë¡¤ ë°©ì§€ ë° ë†’ì´ ì„¤ì • (ëª¨ë“  ë¸Œë¼ìš°ì € í˜¸í™˜)
            function immediateLock() {
                // ì‹¤ì œ viewport ë†’ì´ ê°€ì ¸ì˜¤ê¸°
                let vh = window.innerHeight;
                if (window.visualViewport && window.visualViewport.height) {
                    vh = window.visualViewport.height;
                }
                
                // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ê°•ì œ ê³ ì •
                window.scrollTo(0, 0);
                if (document.documentElement) {
                    document.documentElement.scrollTop = 0;
                }
                if (document.body) {
                    document.body.scrollTop = 0;
                    // ëª¨ë“  ë¸Œë¼ìš°ì €ì—ì„œ ë†’ì´ ì„¤ì • (100dvh fallback)
                    if (vh > 0) {
                        // í˜„ì¬ ë†’ì´ì™€ ì°¨ì´ê°€ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸
                        const currentHeight = document.body.offsetHeight || document.body.clientHeight;
                        if (Math.abs(currentHeight - vh) > 5) {
                            document.body.style.height = vh + 'px';
                            document.body.style.maxHeight = vh + 'px';
                        }
                    }
                }
            }
            
            // ì¦‰ì‹œ ì‹¤í–‰
            immediateLock();
            
            // ë¹ ë¥¸ ê°„ê²©ìœ¼ë¡œ ê³„ì† ì‹¤í–‰
            const immediateInterval = setInterval(() => {
                immediateLock();
            }, 100); // 100msë§ˆë‹¤ ì‹¤í–‰
            
            // ì˜ì›íˆ ì‹¤í–‰ (ì •ë¦¬í•˜ì§€ ì•ŠìŒ)
        })();
    </script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7258774526539144"
     crossorigin="anonymous"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');
        * { box-sizing: border-box; }
        * {
            -webkit-tap-highlight-color: transparent;
        }
        html { 
            width: 100% !important; 
            height: 100% !important;
            overflow: hidden !important; 
            margin: 0 !important;
            padding: 0 !important;
            touch-action: none !important;
            -webkit-overflow-scrolling: none !important;
        }
        body {
            margin: 0 !important;
            padding: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            height: 100dvh !important; /* ë™ì  viewport ë†’ì´ (ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ ëŒ€ì‘) */
            max-height: 100vh !important;
            max-height: 100dvh !important;
            overflow: hidden !important;
            position: relative !important;
            display: flex !important;
            flex-direction: column !important;
            background: #1a1a1a;
            text-align: center; 
            font-family: 'Jua', sans-serif; 
            color: white; 
            touch-action: none !important; 
            -webkit-overflow-scrolling: none !important;
            overscroll-behavior: none !important;
            -webkit-user-select: none !important;
            user-select: none !important;
        }
        /* ê´‘ê³  ì˜ì—­ì˜ ë†’ì´ë¥¼ ìˆ«ìë¡œ ê³ ì • */
        .ad-top {
            background: #333;
            height: 50px !important; 
            min-height: 50px !important;
            line-height: 50px; 
            font-size: 11px; 
            color: #888; 
            flex-shrink: 0;
        }
        #ui-header {
            padding: 15px 10px; 
            background: #222; 
            position: relative; /* ë²„íŠ¼ ë°°ì¹˜ì˜ ê¸°ì¤€ì  */
            display: flex; 
            flex-direction: column; 
            align-items: center;
            justify-content: center;
            flex-shrink: 0; /* í—¤ë”ê°€ ì°Œê·¸ëŸ¬ì§€ì§€ ì•Šê²Œ ë°©ì§€ */
            height: 120px; /* í—¤ë” ë†’ì´ë„ ê³ ì • */
        }
        .title { color: #ffeb3b; font-size: 1.4rem; margin-bottom: 5px; }
        .price-tag { color: #ff5252; font-size: 1.1rem; }
        .stats-text { font-size: 1.2rem; color: #4caf50; }
        .time-text { font-size: 1.1rem; color: #2196f3; }
        .best-time { font-size: 0.9rem; color: #ff9800; }
        #game-container {
            flex: 1 1 0%; /* ìƒë‹¨/í•˜ë‹¨ ê´‘ê³ ë¥¼ ì œì™¸í•œ ë‚¨ì€ ê³µê°„ì„ ê°•ì œë¡œ ê½‰ ì±„ì›€ */
            position: relative;
            width: 100%;
            min-height: 0; /* flex ì•„ì´í…œì´ ì¶•ì†Œë  ìˆ˜ ìˆë„ë¡ */
            max-height: 100%; /* ìµœëŒ€ ë†’ì´ ì œí•œ */
            background: #222;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; /* ì˜ì—­ ë°–ìœ¼ë¡œ ë°€ë ¤ë‚˜ì§€ ì•Šê²Œ ë°©ì§€ */
        }
        canvas {
            display: block;
            background: #2c2c2c;
            /* ì¤‘ìš”: ìº”ë²„ìŠ¤ê°€ ë¶€ëª¨ ì˜ì—­ì„ ì ˆëŒ€ ë„˜ì§€ ëª»í•˜ê²Œ ì„¤ì • */
            max-width: 100%;
            max-height: 100%;
        }
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #start-screen { background-color: #1a1a1a; background-image: url('start.png'); background-size: contain; background-position: center; background-repeat: no-repeat; }
        @media (max-width: 768px) {
            #start-screen { background-size: cover; }
        }
        .overlay h1 { color: #ffeb3b; font-size: 2.5rem; margin-bottom: 20px; text-shadow: 2px 2px #000; }
        .overlay p { text-shadow: 2px 2px #000; }
        .start-content { background: rgba(0, 0, 0, 0.7); padding: 30px 40px; border-radius: 20px; margin-bottom: 20px; backdrop-filter: blur(5px); }
        .btn-main { padding: 22px 55px; font-size: 2rem; font-family: 'Jua'; background: #4caf50; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 5px 0 #2e7d32; }
        #hint-box { position: absolute; top: 50%; z-index: 30; pointer-events: none; }
        #hint-box img { width: 80px; height: auto; display: inline-block; vertical-align: middle; margin-right: 10px; object-fit: contain; }
        #hint-box-text { display: inline-block; vertical-align: middle; color: white; font-size: 1.4rem; line-height: 1.5; font-weight: normal; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); }
        #hint-box-text .highlight { color: #ffeb3b; }
        #buy-btn { position: absolute; width: 90px; height: 90px; border-radius: 50%; border: none; background: #555; color: #888; font-family: 'Jua'; font-size: 1.2rem; cursor: pointer; z-index: 30; box-shadow: 0 6px 0 #333; outline: none; padding: 0; overflow: hidden; transition: background 0.3s, box-shadow 0.3s; }
        #buy-btn img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.6; transition: opacity 0.3s, filter 0.3s; filter: grayscale(100%); }
        #buy-btn.active { background: #ffeb3b; box-shadow: 0 6px 0 #c4a700; }
        #buy-btn.active img { opacity: 1; filter: grayscale(0%); }
        #buy-btn-text { position: absolute; bottom: 5px; left: 0; right: 0; font-size: 0.9rem; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.8); font-weight: bold; z-index: 2; text-align: center; }
        #buy-btn-mobile { display: none; }
        /* íŒì—… ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        #msg-pop { position: absolute; width: 100%; top: 30%; left: 0; font-size: 2.2rem; display: none; text-shadow: 3px 3px #000; z-index: 20; font-weight: bold; pointer-events: none; }
        /* í•˜ë‹¨ ê´‘ê³  ì˜ì—­ í™•ëŒ€ (ìˆ˜ìµ ê·¹ëŒ€í™” ë°°ì¹˜) */
        .ad-bottom { 
            background: #333; 
            height: 100px !important; 
            min-height: 100px !important;
            line-height: 250px; 
            color: #ffeb3b; 
            font-size: 16px; 
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            border-top: 4px solid #444;
            z-index: 20;
        }
        
        /* ê´‘ê³  ì˜ì—­ë„ ë†’ì´ë¥¼ í™•ì‹¤íˆ ìˆ«ìë¡œ ê³ ì •í•´ ì£¼ì„¸ìš” */
        .ad-top { height: 50px !important; flex-shrink: 0; }
        .ad-bottom { height: 100px !important; flex-shrink: 0; }
        #ui-header { flex-shrink: 0; } /* í—¤ë”ê°€ ì°Œê·¸ëŸ¬ì§€ì§€ ì•Šê²Œ ë°©ì§€ */
        
        @media (max-width: 768px) {
            .ad-bottom {
                height: 100px;
                line-height: 100px;
                font-size: 14px;
            }
        }
        /* ì „ë©´ ê´‘ê³ ìš© ì˜¤ë²„ë ˆì´ (ì„±ê³µ ì‹œ ë…¸ì¶œ) */
        #interstitial-ad {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 200;
            display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        .ad-placeholder {
            width: 300px; height: 450px; background: #444; border: 2px dashed #999;
            display: flex; align-items: center; justify-content: center; color: #888;
        }
        
        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ */
        @media (max-width: 768px) {
            .start-buttons {
                flex-direction: row !important;
                flex-wrap: nowrap;
            }
            .start-buttons .btn-main {
                flex: 1;
                min-width: 0;
                font-size: 1.4rem;
                padding: 18px 25px;
                white-space: nowrap;
            }
            .social-buttons {
                flex-direction: column !important;
                gap: 8px !important;
            }
            .social-buttons a,
            .social-buttons button {
                width: 100%;
                max-width: 280px;
            }
            #hint-box { 
                display: none !important;
            }
            #buy-btn { 
                display: none !important;
            }
            #buy-btn-mobile { 
                display: block !important; 
                position: fixed;
                top: 50%;           
                right: 15px;        
                transform: translateY(-50%); 
                width: 75px;        
                height: 75px;
                border-radius: 50%;
                border: none;
                background: #555;
                color: #888;
                font-family: 'Jua';
                font-size: 1.2rem;
                cursor: pointer;
                z-index: 50;
                box-shadow: 0 6px 0 #333;
                outline: none;
                padding: 0;
                overflow: hidden;
                transition: background 0.3s, box-shadow 0.3s;
            }
            #buy-btn-mobile img { 
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                object-fit: cover;
                opacity: 0.6;
                transition: opacity 0.3s, filter 0.3s;
                filter: grayscale(100%);
            }
            #buy-btn-mobile.active { 
                background: #ffeb3b;
                box-shadow: 0 6px 0 #c4a700;
            }
            #buy-btn-mobile.active img { 
                opacity: 1;
                filter: grayscale(0%);
            }
            #buy-btn-text-mobile { 
                position: absolute;
                bottom: 5px;
                left: 0;
                right: 0;
                font-size: 0.75rem;
                color: white;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
                font-weight: bold;
                z-index: 2;
                text-align: center;
            }
            #ui-header { 
                padding: 15px 10px;
                align-items: center;
            }
            .stats-text { font-size: 1rem; }
            .time-text { font-size: 0.9rem; }
            .title { font-size: 1.2rem; }
            .price-tag { font-size: 1rem; }
            .start-content { padding: 20px 25px; }
            .overlay h1 { font-size: 2rem; }
        }
        
        @media (max-width: 480px) {
            #buy-btn-mobile { 
                width: 60px;
                height: 60px;
                top: 50%;
                right: 8px;
                transform: translateY(-50%);
            }
            #buy-btn-text-mobile { 
                font-size: 0.65rem;
            }
            .stats-text { font-size: 0.9rem; }
            .time-text { font-size: 0.8rem; }
        }
    </style>
</head>
<body>
    <div class="ad-top">
        <!-- ìƒë‹¨_ë°°ë„ˆ -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-7258774526539144"
             data-ad-slot="4113884601"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    <div style="font-size: 0.7rem; color: #666; text-align: center; padding: 5px 0; background: #222; border-bottom: 1px solid #444;">Â© 2026 dubaijjondeukcookie. All rights reserved.</div>
    <div id="start-screen" class="overlay">
        <div class="start-content">
            <h1>ğŸ’¸<br>ë‘ë°”ì´ì«€ë“ì¿ í‚¤<br>ì‚¬ë¨¹ì ì„œë¯¼ë“¤ì•„</h1>
            <p>í­ë“±í•˜ëŠ” ë¬¼ê°€ë¥¼ ëš«ê³  ì¿ í‚¤ 10ê°œë¥¼ ìŸì·¨í•˜ì‹­ì‹œì˜¤.</p>
        </div>
        <div class="start-buttons" style="display: flex; flex-direction: column; gap: 10px; justify-content: center; align-items: center;">
        <button class="btn-main" onclick="startGame()">ê²Œì„ ì‹œì‘</button>
            <button class="btn-main" style="background: #666;" onclick="showInfo()">ê²Œì„ ë°©ë²•</button>
        </div>
        <div class="social-buttons" style="margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
            <a href="https://www.instagram.com/dubai_jjjondeuk_cookie/" target="_blank" style="padding: 8px 16px; background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%); color: white; border-radius: 20px; text-decoration: none; font-family: 'Jua'; font-size: 0.85rem; box-shadow: 0 2px 0 #C13584; display: inline-flex; align-items: center; gap: 6px;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" fill="white"/>
                </svg>
                ì¸ìŠ¤íƒ€ê·¸ë¨
            </a>
            <button class="btn-main" style="padding: 8px 16px; font-size: 0.85rem; background: #4caf50;" onclick="shareGame()">ğŸ”— ê²Œì„ ê³µìœ </button>
        </div>
    </div>
    <div id="end-screen" class="overlay" style="display: none;">
        <h1 style="color: #4caf50;">ğŸ‰ ì„±ê³µí•œ ì„œë¯¼!</h1>
        <p>ë‹¹ì‹ ì€ ì§‘ë…ì˜ ì„œë¯¼ì…ë‹ˆë‹¤.<br>ë‘ë°”ì´ ì¿ í‚¤ 10ê°œë¥¼ ë‹¤ ëª¨ì•˜ìŠµë‹ˆë‹¤!</p>
        <p style="font-size: 1.3rem; color: #ffeb3b; margin: 20px 0;">í”Œë ˆì´ ì‹œê°„: <span id="end-time">0</span>ì´ˆ</p>
        <div class="social-buttons" style="margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
            <a href="https://www.instagram.com/dubai_jjjondeuk_cookie/" target="_blank" style="padding: 8px 16px; background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%); color: white; border-radius: 20px; text-decoration: none; font-family: 'Jua'; font-size: 0.85rem; box-shadow: 0 2px 0 #C13584; display: inline-flex; align-items: center; gap: 6px;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" fill="white"/>
                </svg>
                ì¸ìŠ¤íƒ€ê·¸ë¨
            </a>
            <button class="btn-main" style="padding: 8px 16px; font-size: 0.85rem; background: #4caf50;" onclick="shareGame()">ğŸ”— ê²Œì„ ê³µìœ </button>
        </div>
        <button class="btn-main" style="margin-top: 20px;" onclick="location.reload()">ë‹¤ì‹œ í•˜ê¸°</button>
    </div>
    <div id="info-screen" class="overlay" style="display: none;">
        <div style="padding: 20px; color: #888; font-size: 0.9rem; text-align: left; max-width: 500px; margin: 0 auto; line-height: 1.6; background: rgba(0,0,0,0.8); border-radius: 15px; max-height: 80vh; overflow-y: auto;">
            <h3 style="color: #ffeb3b; margin-top: 0;">ğŸ® ê²Œì„ ì†Œê°œ ë° ë°©ë²•</h3>
            <p>ë³¸ ê²Œì„ì€ ê¸‰ê²©íˆ ìƒìŠ¹í•˜ëŠ” ë¬¼ê°€(ë‘ë°”ì´ ì«€ë“ ì¿ í‚¤ ì‹œì„¸)ë¥¼ ê²¬ë””ë©° ì½”ì¸ì„ ëª¨ì•„ ì¿ í‚¤<br>10ê°œë¥¼ êµ¬ë§¤í•˜ëŠ” ì„œë¯¼ë“¤ì„ ìœ„í•œ ê²Œì„ì…ë‹ˆë‹¤.</p>
            <ul>
                <li><b>ì¡°ì‘ ë°©ë²•:</b> ë§ˆìš°ìŠ¤ë‚˜ í„°ì¹˜ë¡œ ìºë¦­í„°ë¥¼ ì¢Œìš°ë¡œ ì´ë™í•˜ì„¸ìš”.</li>
                <li><b>ì•„ì´í…œ:</b> ì½”ì¸ì€ ëˆì„ ì˜¬ë ¤ì£¼ë©°, ë˜¥ì€ ì”ê³ ì˜ 30%ë¥¼ ì°¨ê°í•©ë‹ˆë‹¤.</li>
                <li><b>ëª©í‘œ:</b> ì‹œì„¸ê°€ ë” ì˜¤ë¥´ê¸° ì „ì— ì „ëµì ìœ¼ë¡œ ë‘ì«€ì¿ ë¥¼ êµ¬ë§¤í•˜ì—¬ 10ê°œë¥¼ ì±„ìš°ì„¸ìš”!</li>
            </ul>
            <hr style="border: 0.5px solid #444;">
            <div style="font-size: 10px; color: #555; margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                <p style="margin: 0;"><b>ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨:</b> ë³¸ ì‚¬ì´íŠ¸ëŠ” êµ¬ê¸€ ì• ë“œì„¼ìŠ¤ë¥¼ í†µí•´ ê´‘ê³ ë¥¼ ì†¡ì¶œí•˜ë©°, ì´ë¥¼ ìœ„í•´ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ì¿ í‚¤ ì‚¬ìš©ì„ ê±°ë¶€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            </div>
            <p style="text-align: center; margin-top: 20px; margin-bottom: 0;">Â© 2026 dubaijjondeukcookie. All rights reserved.</p>
        </div>
        <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center;">
            <a href="https://www.instagram.com/dubai_jjjondeuk_cookie/" target="_blank" style="padding: 8px 16px; background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%); color: white; border-radius: 20px; text-decoration: none; font-family: 'Jua'; font-size: 0.85rem; box-shadow: 0 2px 0 #C13584; display: inline-flex; align-items: center; gap: 6px;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" fill="white"/>
                </svg>
                ì¸ìŠ¤íƒ€ê·¸ë¨
            </a>
            <button class="btn-main" style="padding: 8px 16px; font-size: 0.85rem; background: #4caf50;" onclick="shareGame()">ğŸ”— ê²Œì„ ê³µìœ </button>
        </div>
        <button class="btn-main" style="margin-top: 20px;" onclick="closeInfo()">ë‹«ê¸°</button>
    </div>
    <div id="ui-header">
        <div class="title">ğŸ’¸ ë–¡ìƒí•˜ëŠ” ë‘ì«€ì¿ </div>
        <div class="price-tag">í˜„ì¬ ì‹œì„¸: <span id="current-price">4,000</span>ì›</div>
        <div class="stats-text">ì”ê³ : <span id="money">0</span>ì› | ì¿ í‚¤: <span id="inventory" style="color:#ffeb3b">0</span>ê°œ</div>
        <div class="time-text">í”Œë ˆì´ ì‹œê°„: <span id="play-time">0</span>ì´ˆ | ìµœê³  ê¸°ë¡: <span id="best-time" class="best-time">-</span></div>
        <button id="buy-btn-mobile" onclick="buyCookie()">
            <img id="buy-dubai-img-mobile" src="dubai.png" alt="ë‘ë°”ì´">
            <span id="buy-btn-text-mobile">ëˆ ë¶€ì¡±</span>
        </button>
    </div>
    <div id="game-container">
        <div id="hint-box">
            <span id="hint-box-text">ëˆì„ ëª¨ì•„ ì˜¤ë¥¸ìª½ ë²„íŠ¼ìœ¼ë¡œ<br><span class="highlight">ë‘ì«€ì¿  10ê°œ</span>ë¥¼ êµ¬ë§¤í•˜ì„¸ìš”</span>
        </div>
        <div id="msg-pop"></div>
        <canvas id="gameCanvas"></canvas>
        <button id="buy-btn" onclick="buyCookie()">
            <img id="buy-dubai-img" src="dubai.png" alt="ë‘ë°”ì´">
            <span id="buy-btn-text">ëˆ ë¶€ì¡±</span>
        </button>
    </div>
    <div class="ad-bottom">
        <!-- í•˜ë‹¨_ë°°ë„ˆ -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-7258774526539144"
             data-ad-slot="3832164645"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    <div id="interstitial-ad">
        <!-- ì „ë©´ê´‘ê³  -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-7258774526539144"
             data-ad-slot="2800802932"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
        <button class="btn-main" style="margin-top: 20px; background: #666;" onclick="closeAd()">ê´‘ê³  ë‹«ê³  ê²°ê³¼ ë³´ê¸°</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        // ì´ë¯¸ì§€ ë Œë”ë§ í’ˆì§ˆ ê°œì„ 
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = 'high';
        const buyBtn = document.getElementById('buy-btn');
        const msgPop = document.getElementById('msg-pop');
        const container = document.getElementById('game-container');
        
        let gameState = 'ready';
        let money = 0, cookiePrice = 4000, inventory = 0;
        let items = [], particles = [];
        let basket = { x: 0, y: 0, w: 80, h: 80 };
        let globalSpeed = 6, spawnRate = 650, lastSpawnTime = 0;
        let gameStartTime = 0;
        let gameTimer = null;
        
        // ìµœê³  ê¸°ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadBestTime() {
            const bestTime = localStorage.getItem('dubaiCookieBestTime');
            if (bestTime) {
                document.getElementById('best-time').textContent = parseFloat(bestTime).toFixed(1) + 'ì´ˆ';
            }
        }
        
        // ìµœê³  ê¸°ë¡ ì €ì¥
        function saveBestTime(time) {
            const bestTime = localStorage.getItem('dubaiCookieBestTime');
            const currentTime = parseFloat(time);
            if (!bestTime || currentTime < parseFloat(bestTime)) {
                localStorage.setItem('dubaiCookieBestTime', currentTime.toString());
                const bestTimeElement = document.getElementById('best-time');
                if (bestTimeElement) {
                    bestTimeElement.textContent = currentTime.toFixed(1) + 'ì´ˆ';
                }
                return true; // ê¸°ë¡ ê°±ì‹ ë¨
            }
            return false; // ê¸°ë¡ ê°±ì‹  ì•ˆ ë¨
        }
        
        loadBestTime();

        const failMsgs = ["ì”ê³  ë–¡ë½", "ë¬´ì†Œìœ  ì‹¤ì²œ", "ê¸°ë¶€ì²œì‚¬", "ì–´ì´ì¿ ", "ì•„ì´ì¿ "];
        const imgDdong = new Image(); imgDdong.src = 'ddong.png';
        const imgDubai = new Image(); imgDubai.src = 'dubai.png';
        const imgCoin = new Image(); imgCoin.src = 'coin.png';

        function resizeCanvas() {
            // ë¨¼ì € í™”ë©´ ê³ ì •
            lockScreen();
            
            // ì¦‰ì‹œ ì‹¤í–‰ (setTimeout ì œê±°í•˜ì—¬ ë¹ ë¥¸ ë°˜ì‘)
            const container = document.getElementById('game-container');
            if (!container) {
                // containerê°€ ì—†ìœ¼ë©´ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„
                setTimeout(resizeCanvas, 100);
                return;
            }
            
            // containerì˜ ì‹¤ì œ ë†’ì´ë¥¼ ê°€ì ¸ì˜´ (flexê°€ ìë™ìœ¼ë¡œ ê³„ì‚°)
            let containerHeight = container.clientHeight;
            
            // container ë†’ì´ê°€ 0ì´ê±°ë‚˜ ë„ˆë¬´ ì‘ìœ¼ë©´ ì§ì ‘ ê³„ì‚°
            if (containerHeight <= 0 || containerHeight < 200) {
                let viewportHeight;
                if (window.visualViewport && window.visualViewport.height) {
                    viewportHeight = Math.floor(window.visualViewport.height);
                } else {
                    viewportHeight = Math.floor(window.innerHeight);
                }
                
                // ê³ ì •ëœ ìš”ì†Œë“¤ì˜ ë†’ì´ (CSSì—ì„œ ì´ë¯¸ ê³ ì •ë¨)
                const adTopHeight = 50;   // .ad-top: height: 50px !important
                const adBottomHeight = 100; // .ad-bottom: height: 100px !important
                const headerHeight = 120;   // #ui-header: height: 120px
                
                // container ë†’ì´ë¥¼ ì§ì ‘ ê³„ì‚°: ì „ì²´ ë†’ì´ì—ì„œ ê³ ì • ìš”ì†Œë“¤ì„ ëºŒ
                containerHeight = Math.max(viewportHeight - adTopHeight - adBottomHeight - headerHeight, 200);
                
                // containerì˜ ë†’ì´ë¥¼ ì§ì ‘ ì„¤ì •
                container.style.height = containerHeight + 'px';
                container.style.minHeight = containerHeight + 'px';
                container.style.maxHeight = containerHeight + 'px';
            }
            
            // containerì˜ ë†’ì´ë¥¼ ì§ì ‘ ì„¤ì • (flexê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì„ ê²½ìš° ëŒ€ë¹„)
            container.style.height = containerHeight + 'px';
            container.style.minHeight = containerHeight + 'px';
            container.style.maxHeight = containerHeight + 'px';

            // ì¤‘ì•™ ê²Œì„ ì˜ì—­ ë°•ìŠ¤ì˜ ì‹¤ì œ í¬ê¸°ë¥¼ ì¸¡ì •í•´ì„œ ìº”ë²„ìŠ¤ì— ì…í™ë‹ˆë‹¤.
            canvas.width = Math.min(container.clientWidth, 500);
            // ìº”ë²„ìŠ¤ ë†’ì´ëŠ” ìµœì†Œ 200px ë³´ì¥
            canvas.height = Math.max(containerHeight, 200);

            // ìºë¦­í„°(ë°”êµ¬ë‹ˆ) ìœ„ì¹˜ë¥¼ ë°”ë‹¥ì—ì„œ 10px ìœ„ë¡œ ì¬ì¡°ì •í•©ë‹ˆë‹¤.
            // ì•ˆì „ì„± ì²´í¬: canvas.heightê°€ ì¶©ë¶„íˆ í°ì§€ í™•ì¸
            if (canvas.height >= basket.h + 10) {
                basket.x = Math.max(0, Math.min(canvas.width / 2 - basket.w / 2, canvas.width - basket.w));
                basket.y = Math.max(0, canvas.height - basket.h - 10);
            } else {
                // canvasê°€ ë„ˆë¬´ ì‘ìœ¼ë©´ ì¤‘ì•™ì— ë°°ì¹˜
                basket.x = Math.max(0, (canvas.width - basket.w) / 2);
                basket.y = Math.max(0, (canvas.height - basket.h) / 2);
            }
            
            // canvasì˜ ì‹¤ì œ ìœ„ì¹˜ë¥¼ getBoundingClientRectë¡œ ì •í™•íˆ ê³„ì‚°
            const containerRect = container.getBoundingClientRect();
            const canvasRect = canvas.getBoundingClientRect();
            const spacing = 20; // canvasì™€ ì¢Œìš° ìš”ì†Œ ì‚¬ì´ì˜ ê°„ê²©
            
            // canvasì˜ ì™¼ìª½ ë ìœ„ì¹˜ (container ê¸°ì¤€)
            const canvasLeftInContainer = canvasRect.left - containerRect.left;
            // canvasì˜ ì˜¤ë¥¸ìª½ ë ìœ„ì¹˜ (container ê¸°ì¤€)
            const canvasRightInContainer = canvasRect.right - containerRect.left;
            
            // íŒíŠ¸ ë°•ìŠ¤ë¥¼ canvas ì™¼ìª½ ë°–ì— ë°°ì¹˜
            const hintBox = document.getElementById('hint-box');
            if (hintBox) {
                hintBox.style.left = (canvasLeftInContainer - spacing) + 'px';
                hintBox.style.transform = 'translateX(-100%) translateY(-50%)';
                hintBox.style.textAlign = 'right';
            }
            
            // êµ¬ë§¤ ë²„íŠ¼ì„ canvas ì˜¤ë¥¸ìª½ ë°–ì— ë°°ì¹˜ (ë°ìŠ¤í¬í†±ë§Œ)
            if (window.innerWidth > 768) {
                const buyBtn = document.getElementById('buy-btn');
                if (buyBtn) {
                    const btnLeft = canvasRightInContainer + spacing;
                    buyBtn.style.left = btnLeft + 'px';
                    buyBtn.style.right = 'auto';
                    buyBtn.style.position = 'absolute';
                    buyBtn.style.bottom = 'auto';
                    buyBtn.style.top = '50%';
                    buyBtn.style.transform = 'translateY(-50%)';
                }
            }
            // ëª¨ë°”ì¼ì€ CSSì˜ fixed positionìœ¼ë¡œ ì²˜ë¦¬
            
            // ë°”êµ¬ë‹ˆ ìœ„ì¹˜ê°€ í™•ì‹¤íˆ ì„¤ì •ë˜ì—ˆëŠ”ì§€ ìµœì¢… í™•ì¸
            if (canvas.width > 0 && canvas.height > 0) {
                // ë°”êµ¬ë‹ˆê°€ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¬ê±°ë‚˜ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ì¬ì„¤ì •
                if (basket.x < 0 || basket.x + basket.w > canvas.width ||
                    basket.y < 0 || basket.y + basket.h > canvas.height ||
                    (basket.x === 0 && basket.y === 0)) {
                    basket.x = Math.max(0, Math.min(canvas.width / 2 - basket.w / 2, canvas.width - basket.w));
                    basket.y = Math.max(0, Math.min(canvas.height - basket.h - 10, canvas.height - basket.h));
                }
            }
        }
        
        // í™”ë©´ ê³ ì • í•¨ìˆ˜ (ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € ê°•ì œ ê³ ì •) - ë‹¨ìˆœí™” ë²„ì „
        function lockScreen() {
            // ì¦‰ì‹œ ìŠ¤í¬ë¡¤ ë°©ì§€
            window.scrollTo(0, 0);
            if (document.documentElement) {
                document.documentElement.scrollTop = 0;
            }
            if (document.body) {
                document.body.scrollTop = 0;
            }
            
            // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ëŠ” í•­ìƒ í™•ì¸ ë° ê°•ì œ ê³ ì •
            if (window.scrollY !== 0 || window.pageYOffset !== 0 || 
                (document.documentElement && document.documentElement.scrollTop !== 0) || 
                (document.body && document.body.scrollTop !== 0)) {
                window.scrollTo(0, 0);
                if (document.documentElement) document.documentElement.scrollTop = 0;
                if (document.body) document.body.scrollTop = 0;
            }

            // ê´‘ê³  ì˜ì—­ì€ ê±´ë“¤ì§€ ì•ŠìŒ (ê´‘ê³  ìˆ˜ìµ ìœ ì§€)
        }
        
        // ì—¬ëŸ¬ ì´ë²¤íŠ¸ì— ëŒ€ì‘í•˜ì—¬ í™”ë©´ì„ ë‹¤ì‹œ ê·¸ë¦¬ê²Œ í•¨
        function handleResize() {
            lockScreen();
            resizeCanvas();
        }
        
        // ì§€ì†ì ìœ¼ë¡œ í™”ë©´ ê³ ì • ìœ ì§€ (ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ ëŒ€ì‘)
        let lockInterval = null;
        let isInitialized = false;
        
        function startLocking() {
            // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€
            if (lockInterval) {
                clearInterval(lockInterval);
            }
            // setIntervalê³¼ requestAnimationFrame ë‘˜ ë‹¤ ì‚¬ìš©í•˜ì—¬ ì´ì¤‘ ë³´í˜¸
            lockInterval = setInterval(() => {
                lockScreen();
                // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ê°•ì œ ê³ ì •
                if (window.scrollY !== 0 || window.pageYOffset !== 0 || 
                    document.documentElement.scrollTop !== 0 || document.body.scrollTop !== 0) {
                    window.scrollTo(0, 0);
                    if (document.documentElement) document.documentElement.scrollTop = 0;
                    if (document.body) document.body.scrollTop = 0;
                }
            }, 10); // 10msë§ˆë‹¤ í™•ì¸ (ë§¤ìš° ë¹ ë¥¸ ë°˜ì‘)
        }
        
        // ì´ˆê¸°í™” í•¨ìˆ˜ (í•œ ë²ˆë§Œ ì‹¤í–‰)
        function initializeScreenLock() {
            if (isInitialized) return;
            isInitialized = true;
            
            // ì¦‰ì‹œ ì‹¤í–‰
            lockScreen();
            startLocking();
            
            // ì´ˆê¸° ë¡œë“œ ì‹œ (í•œ ë²ˆë§Œ ì‹¤í–‰)
            const loadHandler = () => {
                lockScreen();
                handleResize();
            };
            if (document.readyState === 'complete') {
                loadHandler();
            } else {
                window.addEventListener('load', loadHandler, { once: true });
            }
            
            // DOMContentLoadedì—ì„œë„ ì‹¤í–‰ (í•œ ë²ˆë§Œ ì‹¤í–‰)
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', () => {
                    lockScreen();
                }, { once: true });
            } else {
                lockScreen();
            }
        }
        
        // ì¦‰ì‹œ ì´ˆê¸°í™” ì‹¤í–‰
        initializeScreenLock();
        
        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
        window.addEventListener('beforeunload', () => {
            lockScreen();
            if (lockInterval) {
                clearInterval(lockInterval);
                lockInterval = null;
            }
            if (rafId) {
                cancelAnimationFrame(rafId);
                rafId = null;
            }
            isInitialized = false;
        }, { once: true });
        
        // ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸
        window.addEventListener('resize', () => {
            lockScreen();
            handleResize();
        });
        
        // í™”ë©´ íšŒì „
        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                lockScreen();
                handleResize();
            }, 300);
        });
        
        // ìŠ¤í¬ë¡¤ ë°©ì§€ ê°•í™”
        window.addEventListener('scroll', (e) => {
            e.preventDefault();
            window.scrollTo(0, 0);
            lockScreen();
        }, { passive: false });
        
        document.addEventListener('scroll', (e) => {
            e.preventDefault();
            window.scrollTo(0, 0);
            lockScreen();
        }, { passive: false });
        
        // touchmoveë¡œ ì¸í•œ ìŠ¤í¬ë¡¤ ë°©ì§€ - ê²Œì„ ì¡°ì‘ í—ˆìš©
        document.addEventListener('touchmove', (e) => {
            const target = e.target;
            // canvasë‚˜ ê²Œì„ ì˜ì—­, ë²„íŠ¼, ë§í¬ëŠ” í—ˆìš©
            if (target.tagName === 'CANVAS' || target.closest('#game-container') || 
                target.closest('button') || target.closest('a')) {
                return;
            }
            // ê·¸ ì™¸ì˜ ê²½ìš° ìŠ¤í¬ë¡¤ ì°¨ë‹¨
            e.preventDefault();
            window.scrollTo(0, 0);
        }, { passive: false, capture: false }); // captureë¥¼ falseë¡œ ë³€ê²½í•˜ì—¬ ê²Œì„ ì´ë²¤íŠ¸ê°€ ë¨¼ì € ì²˜ë¦¬ë˜ë„ë¡
        
        // touchstartë„ ì°¨ë‹¨ (ìŠ¤í¬ë¡¤ ì‹œì‘ ìì²´ë¥¼ ë§‰ìŒ) - ê²Œì„ ì¡°ì‘ í—ˆìš©
        document.addEventListener('touchstart', (e) => {
            const target = e.target;
            if (target.tagName === 'CANVAS' || target.closest('#game-container') || 
                target.closest('button') || target.closest('a')) {
                return;
            }
            // ìŠ¤í¬ë¡¤ ì‹œì‘ ë°©ì§€
            if (window.scrollY !== 0 || window.pageYOffset !== 0) {
                window.scrollTo(0, 0);
            }
        }, { passive: false, capture: false }); // captureë¥¼ falseë¡œ ë³€ê²½
        
        // wheel ì´ë²¤íŠ¸ë¡œ ì¸í•œ ìŠ¤í¬ë¡¤ ë°©ì§€
        document.addEventListener('wheel', (e) => {
            e.preventDefault();
        }, { passive: false });
        
        // visualViewport API ì‚¬ìš© (ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ ëŒ€ì‘) - ê°•í™”ëœ ë²„ì „
        if (window.visualViewport) {
            // resize ì´ë²¤íŠ¸: ë†’ì´ ë³€í™”ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€
            window.visualViewport.addEventListener('resize', () => {
                lockScreen();
                setTimeout(() => {
                    lockScreen();
                    handleResize();
                }, 50);
            }, { passive: true });
            
            // scroll ì´ë²¤íŠ¸: ìŠ¤í¬ë¡¤ ì™„ì „ ì°¨ë‹¨
            window.visualViewport.addEventListener('scroll', (e) => {
                e.preventDefault();
                e.stopPropagation();
                window.scrollTo(0, 0);
                if (document.documentElement) document.documentElement.scrollTop = 0;
                if (document.body) document.body.scrollTop = 0;
                lockScreen();
            }, { passive: false });
        }
        
        // requestAnimationFrameìœ¼ë¡œ ì§€ì†ì ìœ¼ë¡œ í™”ë©´ ê³ ì • (ê°€ì¥ í™•ì‹¤í•œ ë°©ë²•)
        let rafId = null;
        function continuousLock() {
            lockScreen();
            rafId = requestAnimationFrame(continuousLock);
        }
        
        // continuousLock ì‹œì‘ (í•œ ë²ˆë§Œ)
        continuousLock();
        
        // ì´ˆê¸° ì‹¤í–‰ - ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œí•˜ì—¬ í™•ì‹¤í•˜ê²Œ
        lockScreen();
        
        // DOMì´ ì¤€ë¹„ë˜ë©´ ì¦‰ì‹œ ì‹¤í–‰
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                lockScreen();
                resizeCanvas();
            });
        } else {
            lockScreen();
            resizeCanvas();
        }
        
        // ì¶”ê°€ë¡œ ì•½ê°„ì˜ ì§€ì—° í›„ì—ë„ ì‹¤í–‰ (ë¸Œë¼ìš°ì €ê°€ ë†’ì´ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŒ)
        setTimeout(() => {
            lockScreen();
            resizeCanvas();
        }, 200);
        
        setTimeout(() => {
            lockScreen();
            resizeCanvas();
        }, 500);

        function startGame() {
            if (gameState !== 'ready') return;
            
            // ê²Œì„ ì‹œì‘ ì „ì— ìº”ë²„ìŠ¤ í¬ê¸°ì™€ ë°”êµ¬ë‹ˆ ìœ„ì¹˜ë¥¼ í™•ì‹¤íˆ ì„¤ì •
            resizeCanvas();
            
            gameState = 'playing';
            document.getElementById('start-screen').style.display = 'none';
            lastSpawnTime = performance.now();
            gameStartTime = performance.now();
            
            // ì•½ê°„ì˜ ì§€ì—° í›„ ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸í•˜ê³  ì´ˆê¸° ë Œë”ë§ (ë¸Œë¼ìš°ì €ê°€ ë ˆì´ì•„ì›ƒì„ ì™„ë£Œí•  ì‹œê°„ì„ ì¤Œ)
            setTimeout(() => {
                resizeCanvas();
                // ë°”êµ¬ë‹ˆê°€ í™•ì‹¤íˆ ë³´ì´ë„ë¡ ì¦‰ì‹œ ë Œë”ë§
                if (canvas.width > 0 && canvas.height > 0) {
                    // ë°”êµ¬ë‹ˆ ìœ„ì¹˜ ìµœì¢… í™•ì¸
                    if (basket.x < 0 || basket.x + basket.w > canvas.width ||
                        basket.y < 0 || basket.y + basket.h > canvas.height) {
                        basket.x = Math.max(0, Math.min(canvas.width / 2 - basket.w / 2, canvas.width - basket.w));
                        basket.y = Math.max(0, Math.min(canvas.height - basket.h - 10, canvas.height - basket.h));
                    }
                    draw();
                }
            }, 50);
            
            // íƒ€ì´ë¨¸ ì‹œì‘
            gameTimer = setInterval(() => {
                if (gameState === 'playing') {
                    const elapsed = (performance.now() - gameStartTime) / 1000;
                    document.getElementById('play-time').textContent = elapsed.toFixed(1);
                }
            }, 100);
            
            // ê²Œì„ ë£¨í”„ ì‹œì‘ ì „ì— í•œ ë²ˆ ë” ë Œë”ë§
            setTimeout(() => {
                if (gameState === 'playing' && canvas.width > 0 && canvas.height > 0) {
                    draw();
                }
            }, 100);
            
            requestAnimationFrame(gameLoop);
        }

        setInterval(() => {
            if (gameState !== 'playing') return;
            cookiePrice += Math.floor(Math.random() * 150) + 150;
            document.getElementById('current-price').innerText = cookiePrice.toLocaleString();
            updateBuyButton();
        }, 1200);

        function updateBuyButton() {
            const buyBtnText = document.getElementById('buy-btn-text');
            const buyBtnMobile = document.getElementById('buy-btn-mobile');
            const buyBtnTextMobile = document.getElementById('buy-btn-text-mobile');
            
            if (money >= cookiePrice) {
                buyBtn.classList.add('active');
                buyBtnText.textContent = "êµ¬ë§¤";
                if (buyBtnMobile) {
                    buyBtnMobile.classList.add('active');
                    buyBtnTextMobile.textContent = "êµ¬ë§¤";
                }
            } else {
                buyBtn.classList.remove('active');
                buyBtnText.textContent = "ëˆ ë¶€ì¡±";
                if (buyBtnMobile) {
                    buyBtnMobile.classList.remove('active');
                    buyBtnTextMobile.textContent = "ëˆ ë¶€ì¡±";
                }
            }
        }

        function showMsg(text, color) {
            msgPop.innerText = text;
            msgPop.style.color = color;
            msgPop.style.display = 'block';
            setTimeout(() => { msgPop.style.display = 'none'; }, 700);
        }

        function createParticle(x, y, text, color) {
            particles.push({ x, y, text, color, opacity: 1, life: 40 });
        }

        function buyCookie() {
            if (gameState !== 'playing') return;
            if (money >= cookiePrice) {
                money -= cookiePrice;
                inventory++;
                showMsg("Flex!", "#ffeb3b");
                updateBuyButton();
                globalSpeed += 0.5;
                spawnRate = Math.max(150, spawnRate - 60);
                if (inventory >= 10) endGame();
            }
        }

        function endGame() {
            gameState = 'end';
            
            // íƒ€ì´ë¨¸ ì •ì§€ ë° ìµœê³  ê¸°ë¡ ì €ì¥
            if (gameTimer) {
                clearInterval(gameTimer);
                gameTimer = null;
            }
            const finalTime = (performance.now() - gameStartTime) / 1000;
            
            // ì—”ë”© í™”ë©´ì— ì‹œê°„ í‘œì‹œ
            const endTimeElement = document.getElementById('end-time');
            if (endTimeElement) {
                endTimeElement.textContent = finalTime.toFixed(1);
            }
            
            // ìµœê³  ê¸°ë¡ ì €ì¥ ë° ê°±ì‹ 
            const isNewRecord = saveBestTime(finalTime);
            if (isNewRecord) {
                // ìµœê³  ê¸°ë¡ ê°±ì‹  ì‹œ UI ì—…ë°ì´íŠ¸
                const bestTimeElement = document.getElementById('best-time');
                if (bestTimeElement) {
                    bestTimeElement.textContent = finalTime.toFixed(1) + 'ì´ˆ';
                }
            }
            
            // 1. ë¨¼ì € ì „ë©´ ê´‘ê³ ë¥¼ ë³´ì—¬ì¤Œ
            document.getElementById('interstitial-ad').style.display = 'flex';
        }

        // ê´‘ê³  ë‹«ê¸° í•¨ìˆ˜
        function closeAd() {
            document.getElementById('interstitial-ad').style.display = 'none';
            // 2. ê·¸ ë‹¤ìŒ ì„±ê³µ í™”ë©´ì„ ë³´ì—¬ì¤Œ
            const finalTime = (performance.now() - gameStartTime) / 1000;
            document.getElementById('end-time').textContent = finalTime.toFixed(1);
            document.getElementById('end-screen').style.display = 'flex';
        }

        // ê²Œì„ ë°©ë²• ë³´ê¸° í•¨ìˆ˜
        function showInfo() {
            document.getElementById('info-screen').style.display = 'flex';
        }

        // ê²Œì„ ë°©ë²• ë‹«ê¸° í•¨ìˆ˜
        function closeInfo() {
            document.getElementById('info-screen').style.display = 'none';
        }

        // ê²Œì„ ê³µìœ  í•¨ìˆ˜
        function shareGame() {
            const gameUrl = 'https://dubai-jjjondeuk-cookie.vercel.app/';
            if (navigator.share) {
                // ëª¨ë°”ì¼ì—ì„œ ê³µìœ  ê¸°ëŠ¥ ì‚¬ìš©
                navigator.share({
                    title: 'ë‘ë°”ì´ì«€ë“ì¿ í‚¤ ê²Œì„',
                    text: 'ë‘ë°”ì´ ì«€ë“ ì¿ í‚¤ë¥¼ ì‚¬ë¨¹ì! ì¬ë¯¸ìˆëŠ” ìƒì¡´ ê²Œì„ì„ í”Œë ˆì´í•´ë³´ì„¸ìš”!',
                    url: gameUrl
                }).catch(err => {
                    console.log('ê³µìœ  ì‹¤íŒ¨:', err);
                    copyToClipboard(gameUrl);
                });
            } else {
                // ë°ìŠ¤í¬í†±ì—ì„œëŠ” í´ë¦½ë³´ë“œì— ë³µì‚¬
                copyToClipboard(gameUrl);
            }
        }

        // í´ë¦½ë³´ë“œì— ë³µì‚¬ í•¨ìˆ˜
        function copyToClipboard(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('ê²Œì„ ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }).catch(err => {
                    fallbackCopyToClipboard(text);
                });
            } else {
                fallbackCopyToClipboard(text);
            }
        }

        // í´ë¦½ë³´ë“œ ë³µì‚¬ ëŒ€ì²´ ë°©ë²•
        function fallbackCopyToClipboard(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.opacity = '0';
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                alert('ê²Œì„ ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } catch (err) {
                alert('ë§í¬ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”: ' + text);
            }
            document.body.removeChild(textArea);
        }

        function spawnItem() {
            const rand = Math.random();
            let type = (rand < 0.25) ? 'poop' : (rand < 0.30 ? 'real' : 'coin');
            items.push({ x: Math.random() * (canvas.width - 50), y: -50, type: type, speed: globalSpeed + Math.random() * 2 });
        }

        function update(time) {
            // ì‹œê°„ì— ë”°ë¼ ë‚œì´ë„ ì¦ê°€ (10ì´ˆë§ˆë‹¤ ì†ë„ 0.3 ì¦ê°€)
            if (gameStartTime > 0) {
                const elapsedSeconds = (time - gameStartTime) / 1000;
                const speedIncrease = Math.floor(elapsedSeconds / 10) * 0.3;
                globalSpeed = 6 + speedIncrease; // ê¸°ë³¸ ì†ë„ 6ì—ì„œ ì‹œì‘í•˜ì—¬ ì ì§„ì ìœ¼ë¡œ ì¦ê°€
                
                // ìƒì„± ì†ë„ë„ ì ì§„ì ìœ¼ë¡œ ë¹¨ë¼ì§ (10ì´ˆë§ˆë‹¤ 20ms ê°ì†Œ, ìµœì†Œ 150ms)
                const rateDecrease = Math.floor(elapsedSeconds / 10) * 20;
                spawnRate = Math.max(150, 650 - rateDecrease);
            }
            
            if (time - lastSpawnTime > 2000) lastSpawnTime = time;
            if (time - lastSpawnTime > spawnRate) {
                spawnItem();
                lastSpawnTime = time;
            }

            for (let i = items.length - 1; i >= 0; i--) {
                items[i].y += items[i].speed;
                if (items[i].y + 40 > basket.y && items[i].x < basket.x + basket.w && items[i].x + 40 > basket.x) {
                    if (items[i].type === 'coin') {
                        money += 500;
                        createParticle(items[i].x, items[i].y, "+500", "#4caf50");
                    } else if (items[i].type === 'poop') {
                        let loss = Math.floor(money * 0.3);
                        money -= loss;
                        createParticle(items[i].x, items[i].y, `-${loss}`, "#ff5252");
                        showMsg(failMsgs[Math.floor(Math.random() * failMsgs.length)], "#ff5252");
                    } else if (items[i].type === 'real') {
                        inventory++;
                        showMsg("ëŸ­í‚¤!", "#4caf50");
                        if (inventory >= 10) endGame();
                    }
                    updateBuyButton();
                    items.splice(i, 1);
                    continue;
                }
                if (items[i].y > canvas.height) items.splice(i, 1);
            }

            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].y -= 1.2;
                particles[i].opacity -= 0.025;
                if (particles[i].opacity <= 0) particles.splice(i, 1);
            }

            document.getElementById('money').innerText = money.toLocaleString();
            document.getElementById('inventory').innerText = inventory;
        }

        function draw() {
            // ìº”ë²„ìŠ¤ í¬ê¸°ê°€ ìœ íš¨í•œì§€ í™•ì¸
            if (canvas.width <= 0 || canvas.height <= 0) {
                // ìº”ë²„ìŠ¤ í¬ê¸°ê°€ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œ ì„¤ì • ì‹œë„
                resizeCanvas();
                return;
            }
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // íŒŒí‹°í´(ìˆ«ì íš¨ê³¼) ê·¸ë¦¬ê¸°
            particles.forEach(p => {
                ctx.fillStyle = `rgba(${p.color === '#4caf50' ? '76,175,80' : '255,82,82'}, ${p.opacity})`;
                ctx.font = "bold 22px Jua";
                ctx.fillText(p.text, p.x, p.y);
            });

            // ë°”êµ¬ë‹ˆ ìœ„ì¹˜ê°€ í•­ìƒ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ë„ë¡ ë³´ì¥
            // ë°”êµ¬ë‹ˆê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¬ìœ¼ë©´ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ë¡œ ì¬ì„¤ì •
            if (basket.y <= 0 || basket.y + basket.h > canvas.height || 
                basket.x < 0 || basket.x + basket.w > canvas.width ||
                (basket.x === 0 && basket.y === 0)) {
                // ë°”êµ¬ë‹ˆë¥¼ í™”ë©´ í•˜ë‹¨ ì¤‘ì•™ì— ë°°ì¹˜
                basket.x = Math.max(0, Math.min(canvas.width / 2 - basket.w / 2, canvas.width - basket.w));
                basket.y = Math.max(0, Math.min(canvas.height - basket.h - 10, canvas.height - basket.h));
            }
            
            // ë°”êµ¬ë‹ˆ ìœ„ì¹˜ë¥¼ ìº”ë²„ìŠ¤ ë²”ìœ„ ë‚´ë¡œ ì œí•œ
            basket.x = Math.max(0, Math.min(basket.x, canvas.width - basket.w));
            basket.y = Math.max(0, Math.min(basket.y, canvas.height - basket.h));

            // ë°”êµ¬ë‹ˆ ê·¸ë¦¬ê¸° (í•­ìƒ ê·¸ë ¤ì§€ë„ë¡ ë³´ì¥)
            ctx.fillStyle = "#5d4037";
            ctx.fillRect(basket.x, basket.y, basket.w, basket.h);
            ctx.fillStyle = "white"; 
            ctx.font = "15px Jua"; 
            ctx.fillText("ì„œë¯¼(ë‚˜)", basket.x + 18, basket.y + 45);

            items.forEach(item => {
                if (item.type === 'coin' && imgCoin.complete && imgCoin.naturalWidth > 0) {
                    const targetHeight = 50;
                    const aspectRatio = imgCoin.naturalWidth / imgCoin.naturalHeight;
                    const targetWidth = targetHeight * aspectRatio;
                    // ê³ í’ˆì§ˆ ë Œë”ë§ì„ ìœ„í•´ ìŠ¤ë¬´ë”© ì¬ì„¤ì •
                    ctx.save();
                    ctx.imageSmoothingEnabled = true;
                    ctx.imageSmoothingQuality = 'high';
                    ctx.drawImage(imgCoin, item.x, item.y, targetWidth, targetHeight);
                    ctx.restore();
                } else if (item.type === 'poop' && imgDdong.complete && imgDdong.naturalWidth > 0) {
                    const targetHeight = 50;
                    const aspectRatio = imgDdong.naturalWidth / imgDdong.naturalHeight;
                    const targetWidth = targetHeight * aspectRatio;
                    ctx.drawImage(imgDdong, item.x, item.y, targetWidth, targetHeight);
                } else if (item.type === 'real' && imgDubai.complete && imgDubai.naturalWidth > 0) {
                    const targetHeight = 50;
                    const aspectRatio = imgDubai.naturalWidth / imgDubai.naturalHeight;
                    const targetWidth = targetHeight * aspectRatio;
                    ctx.drawImage(imgDubai, item.x, item.y, targetWidth, targetHeight);
                } else {
                    ctx.font = "40px Arial";
                    let icon = item.type === 'coin' ? "ğŸª™" : (item.type === 'poop' ? "ğŸ’©" : "ğŸª");
                    ctx.fillText(icon, item.x, item.y + 35);
                }
            });
        }

        const moveBasket = (e) => {
            if (gameState !== 'playing') return;
            let clientX = e.clientX || (e.touches ? e.touches[0].clientX : 0);
            let rect = canvas.getBoundingClientRect();
            basket.x = clientX - rect.left - basket.w / 2;
            if (basket.x < 0) basket.x = 0;
            if (basket.x > canvas.width - basket.w) basket.x = canvas.width - basket.w;
        };

        window.addEventListener('mousemove', moveBasket);
        window.addEventListener('touchmove', moveBasket, { passive: false });
        
        // ìŠ¤í¬ë¡¤ ë°©ì§€ ê°•í™”
        document.addEventListener('scroll', (e) => {
            e.preventDefault();
            window.scrollTo(0, 0);
        }, { passive: false });
        
        // wheel ì´ë²¤íŠ¸ë¡œ ì¸í•œ ìŠ¤í¬ë¡¤ ë°©ì§€
        document.addEventListener('wheel', (e) => {
            if (e.ctrlKey) {
                e.preventDefault();
            }
        }, { passive: false });

        function gameLoop(time) {
            if (gameState === 'playing') {
                // ê²Œì„ ë£¨í”„ ì‹œì‘ ì‹œ ìº”ë²„ìŠ¤ í¬ê¸° í™•ì¸ (ì²˜ìŒ ëª‡ í”„ë ˆì„ë§Œ)
                if (time - gameStartTime < 500) {
                    // ìº”ë²„ìŠ¤ í¬ê¸°ê°€ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œ ì„¤ì •
                    if (canvas.width <= 0 || canvas.height <= 0 || basket.y < 0 || basket.y + basket.h > canvas.height) {
                        resizeCanvas();
                    }
                }
                update(time);
                draw();
                requestAnimationFrame(gameLoop);
            }
        }
    </script>
</body>
</html>
